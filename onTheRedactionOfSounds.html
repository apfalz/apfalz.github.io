<html>
<head>
<title></title>
<link rel="stylesheet" href="stylesheetasdf.css" type="text/css">
</head>
<body  onmousemove="getMousePosition(event)"
      onmousedown="firstPoint(x, y)"
      onmouseup="drawOnBuffer1(x,y)">
     <!-- menu divs -->

    <!-- canvases -->
<canvas id="canv0"; class="onTheRedactionCanvas"; width="900"; height="900"></canvas>  
<canvas id="canv1"; class="onTheRedactionCanvas"; width="900"; height="900"></canvas>
<canvas id="canv2"; class="onTheRedactionCanvas"; width="900"; height="900"></canvas>
<canvas id="canv3"; class="onTheRedactionCanvas"; width="900"; height="900"></canvas>  
<canvas id="canv4"; class="onTheRedactionCanvas"; width="900"; height="900"></canvas>
<canvas id="canv5"; class="onTheRedactionCanvas"; width="900"; height="900"></canvas>
    
<canvas id="clip0"; class="clippingPlane"; width="900"; height="900" ></canvas>
<canvas id="clip1"; class="clippingPlane"; width="900"; height="900" ></canvas>
<canvas id="clip2"; class="clippingPlane"; width="900"; height="900"></canvas>
<canvas id="clip3"; class="clippingPlane"; width="900"; height="900"></canvas>
<canvas id="clip4"; class="clippingPlane"; width="900"; height="900"></canvas>
<canvas id="clip5"; class="clippingPlane"; width="900"; height="900"></canvas>

<canvas id="inter0"; class="intersectionCanvas"; width="900"; height="900"></canvas>
<canvas id="inter1"; class="intersectionCanvas"; width="900"; height="900"></canvas>
<canvas id="inter2"; class="intersectionCanvas"; width="900"; height="900"></canvas>
<canvas id="inter3"; class="intersectionCanvas"; width="900"; height="900"></canvas>
<canvas id="inter4"; class="intersectionCanvas"; width="900"; height="900"></canvas>
<canvas id="inter5"; class="intersectionCanvas"; width="900"; height="900"></canvas>

    

<script>
    
    var canvArray = [0, 0, 0, 0, 0, 0]; //red, green, blue, purple, yellow, black
    var cntxtArray = [];
    var colorArray = ['red', 'green', 'blue', 'purple', 'yellow', 'black'];
    var clipArray = [];
    var clipCntxtArray = [];
    var interArray = [];
    var interCntxtArray = [];
    
  /*  var numberOfCanvases = 6;
    var sizeOfCanvases = "900";
    
    var body = document.getElementsByTagName("body")[0];
    
    for (var i = 0; i < numberOfCanvases; i ++) {
        
        var canv = document.createElement("canvas");
        canv.id = "canv" + i;
        canv.width = sizeOfCanvases;
        canv.height = sizeOfCanvases;
        canv.className = "onTheRedactionCanvas";
        body.appendChild(canv);
        
        var clip = document.createElement("canvas");
        clip.id = "clip" + i;
        clip.width = sizeOfCanvases;
        clip.heigh = sizeOfCanvases;
        body.appendChild(clip);
        
        var inter = document.createElement("canvas");
        inter.id = "inter" + i;
        inter.height = sizeOfCanvases;
        inter.width = sizeOfCanvases;
        body.appendChild(inter);
    }
        
        */
        
    
    
    for (var i = 0; i < 6; i++) {
        canvArray[i] = document.getElementById("canv" + i);
        cntxtArray[i] = canvArray[i].getContext("2d");
        cntxtArray[i].fillStyle=colorArray[i];
        cntxtArray[i].fillRect(0, 0, canvArray[i].width, canvArray[i].height);
       
        clipArray[i] = document.getElementById("clip" + i);
        clipCntxtArray[i] = clipArray[i].getContext("2d");
        
        interArray[i] = document.getElementById("inter" + i);
        interCntxtArray[i] = interArray[i].getContext("2d");
        
    }
    
    
    function getMousePosition(event) {
        var area = canvArray[0].getBoundingClientRect();
         x = event.clientX - area.left;
         y = event.clientY - area.top;
      }
 //on mouse down 
    function firstPoint(x, y) {
        upperLeftX = x;
        upperLeftY = y;
    }

    //on mouse up
    function drawOnBuffer1(x, y) {
        finalX = x;
        finalY = y;
        
        if (upperLeftX - finalX == 0 && upperLeftY - finalY == 0) {
            //console.log("it happened");
            finalX += 1;
            finalY +=1;
        }
            
       
        clipCntxtArray[0].fillRect(upperLeftX, upperLeftY, (finalX - upperLeftX), (finalY - upperLeftY));
        
        
        cntxtArray[0].globalCompositeOperation = "destination-out";
        cntxtArray[0].drawImage(clipArray[0], 0, 0);
        
        for (var i = 0; i < 4; i++) {
            interCntxtArray[i].globalCompositeOperation = "source-in";
            interCntxtArray[i].fillRect(upperLeftX, upperLeftY, (finalX - upperLeftX), (finalY - upperLeftY));
            var currentIntersection = interCntxtArray[i].getImageData(0, 0, interArray[i].width, interArray[i].height) 
            clipCntxtArray[i+1].putImageData(currentIntersection, 0, 0);
            cntxtArray[i + 1].globalCompositeOperation = "destination-out";
            cntxtArray[i + 1].drawImage(clipArray[i + 1], 0, 0);
        }
        

        for(var i = 0; i < 6; i ++) {
            interCntxtArray[i].globalCompositeOperation="source-over";
            var updatedBuffer = clipCntxtArray[i].getImageData(0, 0, interArray[i].width, interArray[i].height);
            interCntxtArray[i].putImageData(updatedBuffer, 0, 0);
        }
        
        
        
        
    }
    

        
    
</script>

      
  

    

     
</body>
</html>